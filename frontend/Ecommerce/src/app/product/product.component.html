<div class="container bg-light rounded p-4">
  <h4>Add Product</h4>
  <form #productForm="ngForm" (ngSubmit)="onSubmit(productForm)">
    
    <!-- Product Name -->
    <div class="mb-3">
      <label>Product Name</label>
      <input type="text" class="form-control" [(ngModel)]="product.productName" name="productName" required #productName="ngModel">
      <div *ngIf="productName.invalid && productName.touched" class="text-danger">
        Product name is required.
      </div>
    </div>

    <!-- Price -->
    <div class="mb-3">
      <label>Price</label>
      <input type="number" class="form-control" [(ngModel)]="product.price" name="price" required min="0.01" #price="ngModel">
      <div *ngIf="price.invalid && price.touched" class="text-danger">
        Price must be greater than 0.
      </div>
    </div>

    <!-- Description -->
    <div class="mb-3">
      <label>Description</label>
      <textarea class="form-control" [(ngModel)]="product.description" name="description"></textarea>
    </div>

    <!-- Quantity -->
    <div class="mb-3">
      <label>Quantity</label>
      <input type="number" class="form-control" [(ngModel)]="product.quantity" name="quantity" required min="1" #quantity="ngModel">
      <div *ngIf="quantity.invalid && quantity.touched" class="text-danger">
        Quantity is required
      </div>
    </div>

    <!-- Category -->
    <div class="mb-3">
      <label>Category</label>
      <select
        class="form-select"
        [(ngModel)]="selectedCategoryId"
        name="category"
        (change)="onCategoryChange()"
        required
      >
        <option [ngValue]="null">Select Category</option>
        <option *ngFor="let c of categories" [ngValue]="c.id">{{ c.name }}</option>
        <option [ngValue]="0">Add New Category</option>
      </select>
    </div>

    <!-- Brand -->
    <div class="mb-3">
      <label>Brand</label>
      <select
        class="form-select"
        [(ngModel)]="product.brand.id"
        name="brand"
        (change)="onBrandChange()"
        required
      >
        <option [ngValue]="null" selected>Select Brand</option>
        <option *ngFor="let b of brands" [ngValue]="b.id">{{ b.name }}</option>
        <option [ngValue]="0">Add New Brand</option>
      </select>
    </div>

   <!-- Image Upload -->
    <div class="mb-3">
      <label>Product Images</label><br>
      <button type="button" class="btn btn-outline-secondary" (click)="fileInput.click()">Choose Images</button>
      <input type="file" #fileInput (change)="onImageSelect($event)" multiple class="d-none">
      <div *ngIf="productForm.submitted && selectedImages.length === 0" class="text-danger mt-2">
        At least one image is required.
      </div>
      <div *ngIf="selectedImages.length > 0" class="text-success mt-2">
        {{ selectedImages.length }} image(s) selected.
      </div>
    </div>

    <!-- Submit -->
    <button class="btn btn-primary w-100" type="submit"
      [disabled]="productForm.invalid || selectedImages.length === 0">
      Add Product
    </button>
  </form>
</div>
